###########################################################################################################################
#  Purpose: Xtrabackup configuration file
#  Name   : xtrabackup_mysql_database.conf
#  Deploy : cat /dev/null >/opt/dba_script/xtrabackup_mysql_database.conf;vi /opt/dba_script/xtrabackup_mysql_database.conf
#  Attention!!!! Do not leave space between equal sign and the value
#
#  History: Jackey Lin  Create                                                                                   2013 07 24
#           Jackey Lin  Adjustable binary log search and reduce default backup throttle                          2013 11 08
#           Jackey Lin  Abort and send alert if existing xtrabackup running                                      2013 12 10
#           Jackey Lin  Wrap abort in a function                                                                 2013 12 11
#           Jackey Lin  Add lock-wait-timeout for Xtrabackup 2.1 to avoid "Waiting for table flush" problem      2014 02 10
###########################################################################################################################
#   Backup directory and retention days
###########################################################################################################################
export BACKUP_BASE={{ pillar.mysql_backup.backup_dir }}
export RETENTION_DAYS={{ pillar.mysql_backup.retention_days }}

###########################################################################################################################
#   Backup type for each weekday( Valid value: full, incr )  
###########################################################################################################################
# Monday
export BACKUPTYPE_DAY1={{ pillar.mysql_backup.backup_type1 }}
# Tuesday
export BACKUPTYPE_DAY2={{ pillar.mysql_backup.backup_type2 }}
# Wednesday
export BACKUPTYPE_DAY3={{ pillar.mysql_backup.backup_type3 }}
# Thursday
export BACKUPTYPE_DAY4={{ pillar.mysql_backup.backup_type4 }}
# Friday
export BACKUPTYPE_DAY5={{ pillar.mysql_backup.backup_type5 }}
# Saturday
export BACKUPTYPE_DAY6={{ pillar.mysql_backup.backup_type6 }}
# Sunday
export BACKUPTYPE_DAY7={{ pillar.mysql_backup.backup_type7 }}

###########################################################################################################################
#   Compression and speed throttle ( MB/second )
###########################################################################################################################
export BACKUP_COMPRESS={{ pillar.mysql_backup.backup_compress }}
export BACKUP_THROTTLE={{ pillar.mysql_backup.backup_throttle }}

###########################################################################################################################
#   Wait time in seconds before issuing FLUSH TABLES WITH READ LOCK 
###########################################################################################################################
export LOCK_WAIT_TIMEOUT={{ pillar.mysql_backup.lock_wait_timeout }}
export LOCK_WAIT_THRESHOLD={{ pillar.mysql_backup.lock_waitthreshold }}

#######################################################################################################
# Storage usage: abort backup if backup mount point space usage exceed this
#######################################################################################################
export BACKUP_MOUNTPOINT={{ pillar.mysql_backup.backup_dir }}
export STORAGE_USAGE_PERC={{ pillar.mysql_backup.storage_usage }}

###########################################################################################################################
#   Binary backup will search binary logs generated in past N minutes.
###########################################################################################################################
export BINLOG_SEARCH_MINS={{ pillar.mysql_backup.binlog_search_mins }}
###########################################################################################################################
#   Send email to DBA to notify backup status, use space to separate email address
###########################################################################################################################
dba_mail={{ pillar.mysql_backup.send_to }}
###########################################################################################################################
#   For backup to remote host only 
###########################################################################################################################
export REMOTE_HOST=
export REMOTE_USER=
export REMOTE_BACKUPDIR=
export REMOTE_TMPDIR=
###########################################################################################################################
#   For further copy to another folder mounted from dump server
###########################################################################################################################
export COPY_PATH=
export COPY_RETENTION_DAYS=
###########################################################################################################################
